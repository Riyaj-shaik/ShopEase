<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ShopEase - Online Shopping & Admin</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Your Script (Alpine components + store) -->
  <script src="script1.js"></script>

  <!-- Alpine.js (load once) -->
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
  ></script>

  <style>
    [x-cloak] {
      display: none !important;
    }
    .fade-enter-active,
    .fade-leave-active {
      transition: opacity 0.5s ease;
    }
    .fade-enter-from,
    .fade-leave-to {
      opacity: 0;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen flex flex-col">

  <div x-data x-init="$store.auth.fetchSession()">

    <!-- Navbar -->
    <nav
      x-show="!$store.auth.loading"
      class="bg-blue-700 text-white px-4 py-3 flex justify-between items-center"
    >
      <a href="home.html" class="text-xl font-bold">ShopEase</a>
      <div class="space-x-4 flex items-center">
        <a href="allproducts.html" class="hover:underline">Shop</a>
        <a href="cart.html" class="hover:underline">Orders</a>
        <a href="#about" class="hover:underline">About</a>

        <!-- Login if not logged in -->
        <a
          x-show="!$store.auth.username"
          href="login.html"
          class="hover:underline"
          >Login</a
        >

        <!-- Admin Panel for admins -->
        <a
          x-show="$store.auth.role === 'ADMIN'"
          href="#adminPanel"
          class="hover:underline"
          >Admin Panel</a
        >

        <!-- Username + Logout if logged in -->
        <span x-show="$store.auth.username" class="font-medium">
          Hi, <span x-text="$store.auth.username"></span>!
        </span>
        <button
          x-show="$store.auth.username"
          @click="$store.auth.logout()"
          class="bg-red-500 px-3 py-1 rounded hover:bg-red-600"
        >
          Logout
        </button>
      </div>
    </nav>

    <!-- Hero Banner -->
    <section class="bg-blue-100 p-10 text-center">
      <h2 class="text-4xl font-bold mb-4">Big Summer Sale!</h2>
      <p class="text-lg mb-6">Up to 50% off on selected items</p>
      <a
        href="Allproducts.html"
        class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700"
        >Shop Now</a
      >
    </section>

    <!-- Main Banner Carousel -->
    <section>
      <div
        id="mainBannerCarousel"
        class="carousel slide mt-2"
        data-bs-ride="carousel"
      >
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img
              src="https://img.freepik.com/free-vector/gradient-shopping-discount-horizontal-sale-banner_23-2150321996.jpg?w=740"
              class="img-fluid d-block w-100"
              style="height: 300px; object-fit: none"
              alt="img"
            />
          </div>
          <div class="carousel-item">
            <img
              src="https://img.freepik.com/premium-vector/online-shopping-background-digital-market-website-mobile-app_269039-163.jpg?w=740"
              class="img-fluid d-block w-100"
              style="height: 300px; object-fit: none"
              alt="..."
            />
          </div>
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#mainBannerCarousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#mainBannerCarousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Featured Products Carousel -->
    <section class="p-8 bg-white">
      <h3 class="text-2xl font-semibold mb-6 text-center">✨ Featured Products</h3>

      <div x-data="carousel()" x-init="fetchProducts()" class="relative max-w-6xl mx-auto">

        <!-- Prev -->
        <button
          @click="prev()"
          class="absolute top-1/2 -left-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10"
        >
          &#8592;
        </button>

        <!-- Next -->
        <button
          @click="next()"
          class="absolute top-1/2 -right-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10"
        >
          &#8594;
        </button>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 transition-all duration-500">
          <template x-for="(product, index) in visibleProducts()" :key="index">
            <div class="bg-gray-100 rounded-xl shadow p-4">
              <div
                @click="window.location.href = `product.html?id=${product.id}`"
                class="cursor-pointer"
              >
                <img
                  :src="product.imageUrl"
                  alt=""
                  class="h-40 w-full object-cover rounded mb-4"
                />
                <h4 class="font-bold text-lg" x-text="product.name"></h4>
                <p class="text-blue-600 font-semibold" x-text="'₹' + product.price.toLocaleString()"></p>
              </div>
              <button
                @click="addToCart(product)"
                class="mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                Add to Cart
              </button>
            </div>
          </template>
        </div>
      </div>
    </section>

    <!-- Mobiles Carousel -->
    <section class="p-8 bg-white">
      <h3 class="text-2xl font-semibold mb-6 text-center">Mobiles</h3>
      <div x-data="carousel('Phone')" x-init="fetchProducts()" class="relative max-w-6xl mx-auto">
        <button @click="prev()" class="absolute top-1/2 -left-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10">&#8592;</button>
        <button @click="next()" class="absolute top-1/2 -right-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10">&#8594;</button>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 transition-all duration-500">
          <template x-for="(product, index) in visibleProducts()" :key="index">
            <div class="bg-gray-100 rounded-xl shadow p-4">
              <div @click="window.location.href = `product.html?id=${product.id}`" class="cursor-pointer">
                <img :src="product.imageUrl" alt="" class="h-40 w-full object-cover rounded mb-4">
                <h4 class="font-bold text-lg" x-text="product.name"></h4>
                <p class="text-blue-600 font-semibold" x-text="'₹' + product.price.toLocaleString()"></p>
              </div>
              <button @click="addToCart(product)" class="mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Add to Cart</button>
            </div>
          </template>
        </div>
      </div>
    </section>

    <!-- Electronics Carousel -->
    <section class="p-8 bg-white">
      <h3 class="text-2xl font-semibold mb-6 text-center">Electronics</h3>
      <div x-data="carousel('Headphones')" x-init="fetchProducts()" class="relative max-w-6xl mx-auto">
        <button @click="prev()" class="absolute top-1/2 -left-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10">&#8592;</button>
        <button @click="next()" class="absolute top-1/2 -right-6 transform -translate-y-1/2 bg-blue-500 text-white rounded-full p-3 shadow hover:bg-blue-600 z-10">&#8594;</button>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 transition-all duration-500">
          <template x-for="(product, index) in visibleProducts()" :key="index">
            <div class="bg-gray-100 rounded-xl shadow p-4">
              <div @click="window.location.href = `product.html?id=${product.id}`" class="cursor-pointer">
                <img :src="product.imageUrl" alt="" class="h-40 w-full object-cover rounded mb-4">
                <h4 class="font-bold text-lg" x-text="product.name"></h4>
                <p class="text-blue-600 font-semibold" x-text="'₹' + product.price.toLocaleString()"></p>
              </div>
              <button @click="addToCart(product)" class="mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Add to Cart</button>
            </div>
          </template>
        </div>
      </div>
    </section>

    <!-- About / Newsletter / Map -->
    <section class="p-10 bg-gray-100 mt-10 text-center" id="about">
      <h2 class="text-3xl font-bold text-blue-700 mb-4">About Us</h2>
      <p class="max-w-3xl mx-auto text-lg text-gray-700">
        Welcome to <strong>ShopEase</strong> – your trusted online shopping partner.
      </p>
    </section>

    <section class="bg-blue-100 py-10 px-6 mt-10 text-center">
      <h2 class="text-2xl font-bold mb-4 text-blue-800">Subscribe to Our Newsletter</h2>
      <form class="flex flex-col md:flex-row justify-center items-center gap-4 max-w-xl mx-auto">
        <input type="email" placeholder="Enter your email" class="w-full md:w-2/3 px-4 py-2 rounded shadow" required>
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Subscribe</button>
      </form>
    </section>

    <section class="p-10 bg-gray-200 mt-10">
      <h2 class="text-2xl font-bold text-center mb-6 text-blue-700">Visit Our Store</h2>
      <div class="flex justify-center">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15312.637533036473!2d80.05383305!3d15.539074099999999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4m0!3e3!4m0!5m2!1sen!2sin!4m0"
          width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy">
        </iframe>
      </div>
    </section>

    <!-- Admin Panel -->
    <section id="adminPanel" x-show="$store.auth.role === 'ADMIN'" x-cloak>
      <div x-data="shopApp()" x-init="fetchProducts()">
        <h2 class="text-3xl font-bold mb-6 text-center text-blue-700">Admin Panel - Product Management</h2>

        <div class="max-w-7xl mx-auto bg-white rounded-lg shadow-xl p-6">

          <div x-show="loading" class="text-center text-blue-600 font-semibold mb-4" x-cloak>
            Loading products for admin...
          </div>
          <div x-show="error" class="text-center text-red-600 font-semibold mb-4" x-text="error" x-cloak></div>

          <!-- Product Form -->
          <h3 class="text-2xl font-semibold mb-4" x-text="editingProduct.id ? 'Edit Product' : 'Add New Product'"></h3>
          <form @submit.prevent="saveProduct" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 p-4 border rounded-lg bg-gray-50">
            <div>
              <label class="block text-sm font-medium text-gray-700">Product Name</label>
              <input type="text" x-model="editingProduct.name" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Description</label>
              <textarea x-model="editingProduct.description" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Price</label>
              <input type="number" step="0.01" x-model.number="editingProduct.price" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Image URL</label>
              <input type="url" x-model="editingProduct.imageUrl" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Category</label>
              <input type="text" x-model="editingProduct.category" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Stock Quantity</label>
              <input type="number" x-model.number="editingProduct.quantity" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" required>
            </div>
            <div class="md:col-span-2 flex justify-end space-x-4">
              <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors">
                <span x-text="editingProduct.id ? 'Update Product' : 'Add Product'"></span>
              </button>
              <button type="button" @click="resetForm()" x-show="editingProduct.id" class="bg-gray-400 text-white px-6 py-2 rounded-md hover:bg-gray-500 transition-colors">Cancel Edit</button>
            </div>
          </form>

          <!-- Product Table -->
          <h3 class="text-2xl font-semibold mb-4">All Products (Admin View)</h3>
          <div class="overflow-x-auto border rounded-lg shadow">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-100">
                <tr>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ID</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Image</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Name</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Price</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Category</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Stock</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Description</th>
                  <th class="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200">
                <template x-for="product in products" :key="product.id">
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 text-sm text-gray-900" x-text="product.id"></td>
                    <td class="py-3 px-4"><img :src="product.imageUrl || 'https://via.placeholder.com/50'" class="w-12 h-12 object-cover rounded-md"></td>
                    <td class="py-3 px-4 text-sm text-gray-900" x-text="product.name"></td>
                    <td class="py-3 px-4 text-sm text-gray-900" x-text="`₹${product.price.toFixed(2)}`"></td>
                    <td class="py-3 px-4 text-sm text-gray-900" x-text="product.category || 'N/A'"></td>
                    <td class="py-3 px-4 text-sm text-gray-900" x-text="product.quantity"></td>
                   
                    <td class="py-3 px-4 text-sm text-gray-500 max-w-xs overflow-hidden text-ellipsis"
                        x-text="product.description || 'No description.'">
                    </td>
                    <td class="py-3 px-4 text-sm font-medium">
                        <button @click="editProduct(product)"
                            class="bg-yellow-500 text-white px-3 py-1 rounded-md text-xs hover:bg-yellow-600 transition-colors mr-2">
                            Edit
                        </button>
                        <button @click="deleteProduct(product.id)"
                            class="bg-red-600 text-white px-3 py-1 rounded-md text-xs hover:bg-red-700 transition-colors">
                            Delete
                        </button>
                    </td>
                  </tr>
                </template>
                <tr x-show="products.length === 0 && !loading && !error">
                    <td colspan="8" class="py-4 px-4 text-center text-gray-500">
                        No products found.
                    </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 text-center mt-auto">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 py-8">
        <div>
          <h4 class="font-bold mb-4">ShopEase</h4>
          <p>Your one-stop shop for everything trendy and essential.</p>
        </div>
        <div>
          <h4 class="font-bold mb-4">Quick Links</h4>
          <ul class="space-y-2">
            <li><a href="login.html" class="hover:underline">Signup/Signin</a></li>
            <li><a href="#" class="hover:underline">Shop</a></li>
            <li><a href="#" class="hover:underline">Orders</a></li>
            <li><a href="#" class="hover:underline">Contact</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Customer Service</h4>
          <ul class="space-y-2">
            <li><a href="#" class="hover:underline">FAQs</a></li>
            <li><a href="#" class="hover:underline">Shipping & Returns</a></li>
            <li><a href="#" class="hover:underline">Order Tracking</a></li>
            <li><a href="#" class="hover:underline">Support</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Connect With Us</h4>
          <ul class="space-y-2">
            <li><a href="https://www.facebook.com/PACEOngole/" class="hover:underline">Facebook</a></li>
            <li><a href="https://www.instagram.com/explore/locations/298637787005648/pace-institute-of-technology-sciences-ongole/" class="hover:underline">Instagram</a></li>
            <li><a href="https://twitter.com" class="hover:underline">Twitter</a></li>
            <li><a href="https://in.linkedin.com/in/pace-its-ongole-133467285" class="hover:underline">LinkedIn</a></li>
          </ul>
        </div>
      </div>
      <div class="text-center mt-8 border-t border-gray-700 pt-4 text-sm text-gray-400">
        © 2025 ShopEase. All rights reserved.
      </div>
    </footer>

  </div>
</body>
</html>
